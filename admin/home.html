<html>
    <head>
        <title>N A S T Y | Dashboard</title>
        <link rel="icon" href="./assets/img/Nasty Logo.png">
        <link rel="stylesheet" href="../main.css">
        <link rel="shortcut icon" type="image/x-icon" href="logo.png" />

        <!-- JavaScript -->
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/1.1.4/typed.min.js"></script>

        <link href="https://fonts.googleapis.com/css?family=Nova+Flat" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow" rel="stylesheet">

        <!-- CSS -->
        <style>
            ul {
                list-style-type: none;
                margin: 0;
                padding: 0;
                overflow: hidden;
                background-color: #7289DA;
            }
            li {
                float: right;
                cursor: pointer;
            }
            li a {
                display: block;
                color: white;
                text-align: center;
                padding: 14px 16px;
                text-decoration: none;
                cursor: pointer;
            }
            li a:hover {
                background-color: #111;
            }
            body, html {
                height: 100%;
                margin: 0;
            }

            .bgimg {
                background-image: url('http://isyntheticoil.com/wp-content/uploads/2012/11/Aircraft-Good-Desktop-Background-Pictures-1920x1200.jpg');
                height: 100%;
                background-position: center;
                background-size: cover;
                position: relative;
                color: black;
                font-family: "Courier New", Courier, monospace;
                font-size: 25px;
            }

            .topleft {
                position: absolute;
                top: 0;
                left: 16px;
            }

            .bottomleft {
                position: absolute;
                bottom: 0;
                left: 16px;
            }

            .middle {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                text-align: center;
            }

            hr {
                margin: auto;
                width: 40%;
            }
        </style>

    </head>

    <body>
        <div class="topleft">
          <img id="avatar">
        </div>        
        <div class="bgimg">
          <div class="middle">
            <h1>COMING SOON</h1>
            <hr>
              <p>Join the <a href="">Discord Server</a> for Updates on this site!</p>
              <p>Sorry, <span id="userid"></span>, this site is under development.</p>
              <p><a onclick="logout();">Click here to log out</a></p>
          </div>
        </div>
        
        <script>
            if (getCookie('access_token')) {
                let xhr = new XMLHttpRequest()
                xhr.open('GET', 'https://discordapp.com/api/v6/users/@me', true);
                xhr.setRequestHeader('Authorization', getCookie('token_type') + " " + getCookie('access_token'));
                xhr.send();
                xhr.onloadend = (e) => {
                    let user = JSON.parse(xhr.responseText);
                    //document.getElementById('login').style.display = "none";
                    //document.getElementById('logout').style.display = "inline-block";
                    document.getElementById('userid').innerHTML = `${user.username}<span style="font-size: .7em; color: black">#${user.discriminator}</span>`
                    //document.getElementById('username').innerHTML = user.username;
                    document.getElementById('avatar').src = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`;
                };
            } else {
                setCookie('access_token', 'delet this', -100000);
                alert("[ALERT] >> You need to log in inorder to access this page!");
                window.location = "/index.html";
            }
            function logout() {
                setCookie('access_token', 'delet this', -100000);
                alert("[NOTICE] >> Logout successful! Redirecting to main page...");
                window.location = "/index.html";
            }
            function getCookie(cname) {
                var name = cname + "=";
                var decodedCookie = decodeURIComponent(document.cookie);
                var ca = decodedCookie.split(';');
                for(var i = 0; i <ca.length; i++) {
                    var c = ca[i];
                    while (c.charAt(0) == ' ') {
                        c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                        return c.substring(name.length, c.length);
                    }
                }
                return null;
            }
            function setCookie(cname, cvalue, exms) {
                var d = new Date();
                d.setTime(d.getTime() + exms);
                var expires = "expires="+ d.toUTCString();
                document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }
        </script>
    </body>
</html>
